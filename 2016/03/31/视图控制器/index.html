<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>谈谈UIViewController | 小明童鞋的窝</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="UIViewController的初始化对于SB创建的VC，VC使用initWithCoder:进行初始化；
其他情况，VC是使用init:方法进行对象初始化，系统提供的UIViewController类init:实现过程中还会调用initWithNibName:bundle:方法完成VC的。
###VC.view的初始化 - loadView
无特殊情况，视图的初始化工作，可以在viewDidL">
<meta property="og:type" content="article">
<meta property="og:title" content="谈谈UIViewController">
<meta property="og:url" content="https://samingzhong.github.io/2016/03/31/视图控制器/index.html">
<meta property="og:site_name" content="小明童鞋的窝">
<meta property="og:description" content="UIViewController的初始化对于SB创建的VC，VC使用initWithCoder:进行初始化；
其他情况，VC是使用init:方法进行对象初始化，系统提供的UIViewController类init:实现过程中还会调用initWithNibName:bundle:方法完成VC的。
###VC.view的初始化 - loadView
无特殊情况，视图的初始化工作，可以在viewDidL">
<meta property="og:updated_time" content="2016-08-11T08:10:44.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="谈谈UIViewController">
<meta name="twitter:description" content="UIViewController的初始化对于SB创建的VC，VC使用initWithCoder:进行初始化；
其他情况，VC是使用init:方法进行对象初始化，系统提供的UIViewController类init:实现过程中还会调用initWithNibName:bundle:方法完成VC的。
###VC.view的初始化 - loadView
无特殊情况，视图的初始化工作，可以在viewDidL">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">小明童鞋的窝</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">爱生活，爱编程。</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://samingzhong.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-视图控制器" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/03/31/视图控制器/" class="article-date">
  <time datetime="2016-03-31T08:17:15.000Z" itemprop="datePublished">2016-03-31</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/能工巧匠集/">能工巧匠集</a>►<a class="article-category-link" href="/categories/能工巧匠集/iOS开发/">iOS开发</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      谈谈UIViewController
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="UIViewController的初始化"><a href="#UIViewController的初始化" class="headerlink" title="UIViewController的初始化"></a>UIViewController的初始化</h2><p>对于SB创建的VC，VC使用initWithCoder:进行初始化；</p>
<p>其他情况，VC是使用init:方法进行对象初始化，系统提供的UIViewController类init:实现过程中还会调用initWithNibName:bundle:方法完成VC的。</p>
<p>###VC.view的初始化 - loadView</p>
<p><strong>无特殊情况，视图的初始化工作，可以在viewDidLoad里完成。</strong></p>
<blockquote>
<p>-(void)loadView; <em>// This is where subclasses should create their custom view hierarchy if they aren’t using a nib. Should never be called directly.</em></p>
</blockquote>
<p>如果子类VC不是使用nib方式定义其视图层级关系，那么应该在此自定义视图层级关系，不应直接调用。</p>
<p><em>说明:</em> <strong>如果是使用与VC同名的xib初始化VC.view（比如使用SB、VC自动生成的xib），一定不要重写loadView方法。</strong>如果重写了，那么xib里边的视图会失效。</p>
<p>如果真要在此自定义VC.view，一般的做法就是</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">//NSLog(@&quot;self.view:%@&quot;, self.view);//千万不要这么干！！VC.view属性的getter会陷入loadView的死循环里。</div><div class="line">CustomView *customView = [[CustomView alloc]initWithFrame:[UIScreen mainScreen].bounds];</div><div class="line">//configure the customView ...</div><div class="line">self.view =view;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">@property(null_resettable, nonatomic,strong) UIView *view; // The getter first invokes [self loadView] if the view hasn&apos;t been set yet. Subclasses must call super if they override the setter or getter.</div><div class="line">//VC中的view属性的getter如果为nil时，那么就会第一时间调loadView去初始化view。</div></pre></td></tr></table></figure>
<h3 id="API-loadView的说明"><a href="#API-loadView的说明" class="headerlink" title="API-loadView的说明"></a>API-loadView的说明</h3><blockquote>
<p><strong>You should never call this method directly. The view controller calls this method when its view property is requested but is currently nil. This method loads or creates a view and assigns it to the view property.</strong></p>
</blockquote>
<p>当VC访问view属性并发现其为nil时，就会去调用loadView加载视图，此方法正是为此而创建一个view并赋值给VC.view而生的。</p>
<blockquote>
<p><strong>If the view controller has an associated nib file, this method loads the view from the nib file. A view controller has an associated nib file if the nibName property returns a non-nil value, which occurs if the view controller was instantiated from a storyboard, if you explicitly assigned it a nib file using the initWithNibName:bundle: method, or if iOS finds a nib file in the app bundle with a name based on the view controller’s class name. If the view controller does not have an associated nib file, this method creates a plain UIView object instead.</strong><br><strong>如果VC已经跟一个nib文件关联，loadView方法会去nib文件里加载视图作为VC的view。一个VC的nibName属性非空就说明已经关联了一个nib文件，</strong>一般出现在使用StoryBoard设计VC、明确使用 initWithNibName:bundle: 去初始化VC、或者iOS在app里发现一个nib文件跟VC类同名。** 最后，如果VC没有关联任何的nib文件，那么loadView方法就会给VC.view创建一个空白的UIView对象。</p>
<p><strong>If you use Interface Builder to create your views and initialize the view controller, you must not override this method.</strong></p>
<p><strong>You can override this method in order to create your views manually. If you choose to do so, assign the root view of your view hierarchy to the view property. The views you create should be unique instances and should not be shared with any other view controller object. Your custom implementation of this method should not call super.</strong></p>
<p><strong>If you want to perform any additional initialization of your views, do so in the viewDidLoad method.</strong></p>
</blockquote>
<p>如果你使用IB来创建你的视图并用来初始化你的VC，切勿重载此方法。</p>
<p>你可以通过重载此方法去手动创建你的视图。如果你这么干了，请把创建的视图的根视图赋值给VC.view。创建出来的视图应该是个独一无二的实例，且请勿与其他VC对象共享之。里边也不应该调用父类的这个方法。</p>
<p>如果你想对视图做一些额外的初始化工作，请在viewDidLoad方法里完成。</p>
<p>总之：<strong>无特殊情况，视图的初始化工作，可以在viewDidLoad里完成。</strong></p>
<h2 id="UIViewController的生命周期"><a href="#UIViewController的生命周期" class="headerlink" title="UIViewController的生命周期"></a>UIViewController的生命周期</h2><p>vcA 从出现到push到vcB：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">1. A viewDidLoad  </div><div class="line">2. A viewWillAppear  </div><div class="line">3. A viewDidAppear  </div><div class="line">4. B viewDidLoad  </div><div class="line">5. A viewWillDisappear  </div><div class="line">6. B viewWillAppear  </div><div class="line">7. A viewDidDisappear</div><div class="line">8. B viewDidAppear</div></pre></td></tr></table></figure>
<p>vcB pop回 vcA，则：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">1. B viewWillDisappear  </div><div class="line">2. A viewWillAppear  </div><div class="line">3. B viewDidDisappear  </div><div class="line">4. A viewDidAppear  </div><div class="line">5. B dealloc//A视图已经出现之后，vcB对象销毁。</div></pre></td></tr></table></figure>
<p><strong>值得注意的是，B视图pop回来的时候前一个视图控制器<code>vcB</code>在A视图<code>viewDidAppear</code>后才被销毁。</strong></p>
<h2 id="再见，viewDidUnload方法"><a href="#再见，viewDidUnload方法" class="headerlink" title="再见，viewDidUnload方法"></a>再见，viewDidUnload方法</h2><p><em>从 iOS 6 开始，viewDidUnload 方法被废弃掉了，应用收到 memory warning 时也不会再调用 viewDidUnload 方法。</em></p>
<p>在 iOS6 时，当系统发出 MemoryWarning 时，<strong>系统会自动回收 bitmap 类</strong>。但是不回收 UIView 和 CALayer 类。这样即回收了大部分内存，又能在需要 bitmap 类时，通过调用 UIView 的 drawRect: 方法重建。如果贸贸然把self.view = nil;那么下次需要用到该视图时就需要重新做loadView的活了，而且还会触发viewDidLoad等等一系列创建视图的方法。</p>
<p> -摘自:<br> <a href="http://blog.devtang.com/2013/05/18/goodbye-viewdidunload/" target="_blank" rel="external">唐巧的技术博客</a></p>
<h2 id="关于self-view-frame在viewDidLoad与viewWillApear的差异"><a href="#关于self-view-frame在viewDidLoad与viewWillApear的差异" class="headerlink" title="关于self.view.frame在viewDidLoad与viewWillApear的差异"></a>关于self.view.frame在viewDidLoad与viewWillApear的差异</h2><p>基本是因为vc对xib文件的加载是原封不动的尺寸加载这种方式引起的，但是最后都能正确显示是因为self.view的autoresize = W+H，这个自动调整尺寸的属性让frame最后显示时根据屏幕尺寸做了自动调整。</p>

      
    </div>
    <footer class="article-footer">
 
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2016/06/20/《iOS7 Programming Cookbook》第一章UIViewController与view－读书笔记/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          《iOS7 Programing Cookbook》第1章 实现控制器及其视图－笔记
        
      </div>
    </a>
  
  
    <a href="/2016/03/15/如何避免循环引用/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">关于避免强引用循环</div>
    </a>
  
</nav>

  
</article>


  <section id="comments">
    <!-- 多说评论框 start -->
    <div class="ds-thread" data-thread-key="post-视图控制器" data-title="谈谈UIViewController" data-url="https://samingzhong.github.io/2016/03/31/视图控制器/"></div>
    <!-- 多说评论框 end -->
    <!-- 多说公共JS代码 start (一个网页只需插入一次) -->
    <script type="text/javascript">
    var duoshuoQuery = {short_name:'samingzhong'};
      (function() {
        var ds = document.createElement('script');
        ds.type = 'text/javascript';ds.async = true;
        ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0] 
         || document.getElementsByTagName('body')[0]).appendChild(ds);
      })();
      </script>
    <!-- 多说公共JS代码 end -->
  </section>
  </section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/杂谈集/">杂谈集</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/能工巧匠集/">能工巧匠集</a><span class="category-list-count">5</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/能工巧匠集/iOS开发/">iOS开发</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/能工巧匠集/工欲善其事必先利其器/">工欲善其事必先利其器</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/读书笔记/">读书笔记</a><span class="category-list-count">2</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/读书笔记/《iOS7-Programing-Cookbook》/">《iOS7 Programing Cookbook》</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/面试-招聘/">面试/招聘</a><span class="category-list-count">2</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/面试-招聘/《招聘一个靠谱的iOS》/">《招聘一个靠谱的iOS》</a><span class="category-list-count">2</span></li></ul></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2016/08/30/8月杂谈/">8月杂谈</a>
          </li>
        
          <li>
            <a href="/2016/08/16/《招聘一个靠谱的iOS》面试题参考答案（下）/">《招聘一个靠谱的 iOS》—参考答案（下）</a>
          </li>
        
          <li>
            <a href="/2016/08/16/《招聘一个靠谱的iOS》面试题参考答案（上）/">《招聘一个靠谱的 iOS》—参考答案（上）</a>
          </li>
        
          <li>
            <a href="/2016/08/14/关于常见的协议－归解档、深浅拷贝/">关于常见的协议－归/解档、深/浅拷贝</a>
          </li>
        
          <li>
            <a href="/2016/08/09/开发工具备忘/">开发工具备忘</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Git/">Git</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NSCoding/">NSCoding</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NSCopying-NSMutableCopying/">NSCopying/NSMutableCopying</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Retain-Cycle/">Retain Cycle</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Tower/">Tower</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/iOS面试-招聘/">iOS面试/招聘</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/开发工具备忘/">开发工具备忘</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/杂谈/">杂谈</a><span class="tag-list-count">3</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/Git/" style="font-size: 10px;">Git</a> <a href="/tags/NSCoding/" style="font-size: 10px;">NSCoding</a> <a href="/tags/NSCopying-NSMutableCopying/" style="font-size: 10px;">NSCopying/NSMutableCopying</a> <a href="/tags/Retain-Cycle/" style="font-size: 10px;">Retain Cycle</a> <a href="/tags/Tower/" style="font-size: 10px;">Tower</a> <a href="/tags/iOS面试-招聘/" style="font-size: 15px;">iOS面试/招聘</a> <a href="/tags/开发工具备忘/" style="font-size: 10px;">开发工具备忘</a> <a href="/tags/杂谈/" style="font-size: 20px;">杂谈</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">八月 2016</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">七月 2016</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">六月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">三月 2016</a><span class="archive-list-count">2</span></li></ul>
    </div>
  </div>


  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 小明童鞋<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>



<script src="/js/script.js"></script>

  </div>
</body>
</html>